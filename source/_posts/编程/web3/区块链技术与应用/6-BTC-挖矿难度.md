---
title: BTC-挖矿难度
categories: 编程
tags:
  - web3
  - BTC
date: 2022-12-30 20:00:23
---

本系列开始区块链的学习，主要内容为B站上[北京大学肖臻老师《区块链技术与应用》公开课](https://www.bilibili.com/video/BV1Vt411X7JF?p=1&vd_source=22653c02dfbe0c9c7bb4a200eb87fe4e)

H(block header) <= target
target 越小，难度越高

算法是SHA-256 就是256位二进制位

difficulty = difficulty_1_target/target (difficulty_1_target位挖矿难度等于1时对应的目标阈值，挖矿难度最小就是1)

### 为什么要调整挖矿难度？
系统总算力越来越强，挖矿速度越来越快，挖矿时间越来越短。调整挖矿难度就是为了确保挖矿的时间能按照差不多固定的时间来

出块时间时间越来越短的话分叉的可能就越来越多，分叉越多算力越分散，分叉过多对系统的安全性没有任何的保证。BTC协议假设大部分算力掌握在诚实的矿工手中的，系统的总算力越强，系统就越安全。
理论上只要有人有51%的算力就可以发动`51% attack`
分叉越多的时候，算力就回被分散，此时不需要51%的算力就可能攻击成功。比如现在有10个分叉，那系统现在的算力现在被分散成十份，每个分叉分摊10%的算力，此时如果有一个恶意节点有超过10%的算力就很有可能构造出最长合法链。

出块时间变短的好处：交易能较快的被写入区块中。

出块时间：BTC 10分钟， ETH 15s

### 怎么调整挖矿难度？
BTC中规定每隔2016区块（2016*10/(24*60) = 14天）要调整挖矿难度
调整公式：target = target * (actual time / expected time)
实际花费的时间大于预期时间，会调高target降低挖矿难度，反之亦然。

**恶意节点不调整挖矿难度怎么办？**
每个区块中有一个nBits字段是target编码的版本标识当前的挖矿难度，如果恶意节点不调整，诚实的矿公是不会确认的。

### BTC的数量是一定的，每个区块的限制是1M，那么BTC的总容量也就是固定的，那BTC有发展空间吗？